<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>Will you be my girlfriend? üíñ</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#fff0f8;
    --accent:#ff6fb5;
    --accent2:#ffd166;
    --muted:#444;
  }
  html,body{height:100%;margin:0;font-family: 'Poppins', system-ui, sans-serif;background:linear-gradient(160deg,#ffeef7 0%, #fff7ea 60%);overflow:hidden}
  .wrap{position:relative; z-index:2; min-height:100vh; display:flex; align-items:center; justify-content:center; flex-direction:column; gap:12px; padding:24px; text-align:center}
  h1{font-size: clamp(20px,6vw,36px); margin:0 0 6px; color:var(--muted)}
  p.lead{margin:0;color:#7d5a7a; font-size:clamp(13px,3.4vw,16px)}
  .buttons{display:flex; gap:14px; align-items:center; justify-content:center; margin-top:14px; flex-wrap:wrap}
  .btn{position:relative;padding:16px 26px;border-radius:14px;font-weight:800;font-size:18px;cursor:pointer;user-select:none;box-shadow:0 8px 22px rgba(0,0,0,0.12);min-width:140px;min-height:52px;touch-action:manipulation;background:#fff}
  .btn:focus{outline:3px solid rgba(255,111,181,0.16)}
  .yes{background:linear-gradient(135deg,#ff9ccf,#ff6fb5);color:white;border:none; transition:transform .16s ease, box-shadow .16s ease; will-change:transform}
  .yes:hover{ transform:scale(1.04); box-shadow:0 16px 38px rgba(255,111,181,0.22) }
  .no{background:linear-gradient(135deg,#ffffff,#ffe6f1);border:2px solid #ffd6ea;color:#b9417b; transition:transform .22s cubic-bezier(.18,.9,.4,1)}
  .no.wiggle{ animation: wiggle .8s ease-in-out; }
  @keyframes wiggle{ 0%{transform:translateX(0)}25%{transform:translateX(-8px)}50%{transform:translateX(6px)}75%{transform:translateX(-4px)}100%{transform:translateX(0)} }

  /* Tooltip (desktop hover) */
  .tooltip{
    position:absolute; bottom: calc(100% + 12px); left:50%; transform:translateX(-50%) translateY(6px);
    background:#fff;padding:10px 12px;border-radius:10px;box-shadow:0 8px 30px rgba(0,0,0,0.12);
    font-size:13px;color:#6b3a58;white-space:nowrap; opacity:0; pointer-events:none; transition:all .16s;
    z-index:6;
  }
  .btn:hover .tooltip{ opacity:1; transform:translateX(-50%) translateY(0); }

  .modal{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(10,10,10,0.45);z-index:50;opacity:0;pointer-events:none;transition:opacity .2s}
  .modal.open{opacity:1;pointer-events:auto}
  .dialog{background:linear-gradient(180deg,#fff 0%, #fff7ff 100%);border-radius:16px;padding:18px;width:min(720px,94%);text-align:center;box-shadow:0 18px 60px rgba(0,0,0,0.28);position:relative;max-height:86vh;overflow:auto}
  .profile-row{display:flex;gap:12px;align-items:center;justify-content:center;margin-bottom:10px}
  .profile-row img{width:88px;height:88px;object-fit:cover;border-radius:12px;box-shadow:0 10px 28px rgba(255,111,181,0.14)}
  .love-stream{display:flex;gap:6px;justify-content:center;flex-wrap:wrap;margin-top:12px}
  .love-stream span{font-size:22px;animation:pop 1.2s ease-in-out infinite}
  @keyframes pop{0%{transform:translateY(0) scale(.9)}50%{transform:translateY(-8px) scale(1.12)}100%{transform:translateY(0) scale(.95)}}

  /* Letter box */
  .letterBox{margin-top:12px;text-align:left;background:#fff7fb;border-radius:12px;padding:14px;box-shadow:0 6px 20px rgba(0,0,0,0.06);font-size:15px;color:#5b3a53;line-height:1.45;min-height:110px}
  .letterText{white-space:pre-wrap; min-height:90px; font-family:inherit; font-size:15px}

  /* chocolate & panda gift */
  .giftWrap{margin-top:12px;display:flex;flex-direction:column;gap:8px;align-items:center}
  .choc{width:160px;height:160px;object-fit:contain;border-radius:12px;box-shadow:0 12px 36px rgba(0,0,0,0.12);opacity:0;transform:scale(.8);transition:all .42s cubic-bezier(.2,.9,.28,1)}
  .choc.revealed{opacity:1;transform:scale(1)}
  .panda{width:140px;height:140px;object-fit:contain;border-radius:12px;box-shadow:0 12px 36px rgba(0,0,0,0.12);opacity:0;transform:translateY(8px);transition:all .42s ease}
  .panda.revealed{opacity:1;transform:translateY(0)}
  .giftBtns{display:flex;gap:10px;flex-wrap:wrap;justify-content:center;margin-top:6px}

  .small{padding:10px 14px;border-radius:10px;font-weight:700;background:#fff;border:2px solid #f1d3e4;color:#6a3653}
  .download{background:linear-gradient(135deg,#ffd166,#ffb6d5);color:#5b2a4a;border:none;padding:10px 14px;border-radius:10px;font-weight:800}

  /* counters */
  .counters{position:absolute;top:14px;right:14px;background:rgba(255,255,255,0.75);padding:8px 10px;border-radius:12px;font-size:13px;color:#6b3a58;box-shadow:0 8px 18px rgba(0,0,0,0.08)}

  /* hidden iframes */
  .iframes{display:none}

  /* responsive */
  @media (max-width:480px){
    .profile-row img{width:72px;height:72px}
    .choc{width:140px;height:140px}
    .btn:hover .tooltip{ opacity:0; transform:translateX(-50%) translateY(6px);} /* no hover on small screens */
  }

  /* confetti canvas sits behind modal but above background (higher z-index than wrap) */
  canvas.confetti-canvas{position:fixed; inset:0; z-index:60; pointer-events:none}
</style>
</head>
<body>
<div class="wrap" id="pageWrap">
  <h1>Will you be my girlfriend? üíó</h1>
  <p class="lead">Because I‚Äôll make you smile every single day. Choose carefully (but I hope you choose yes!)</p>

  <div class="buttons">
    <button id="yesBtn" class="btn yes" type="button">YES ‚ù§</button>
    <button id="noBtn" class="btn no" type="button">NO üòø
      <div class="tooltip" id="noTooltip">Hover for a reason...</div>
    </button>
  </div>
</div>

<!-- small counters -->
<div class="counters" aria-hidden="false">
  <div>No taps: <span id="noCount">0</span></div>
  <div>Yes taps: <span id="yesCount">0</span></div>
</div>

<!-- modal -->
<div id="modal" class="modal" aria-hidden="true">
  <div class="dialog" role="dialog" aria-modal="true" aria-labelledby="yesTitle">
    <div class="profile-row">
      <img id="imgYou" src="you.jpg" alt="You (replace you.jpg)">
      <img id="imgCrush" src="crush.jpg" alt="Her (replace crush.jpg)">
    </div>

    <h2 id="yesTitle">She said YES! üéâ</h2>
    <p style="margin:6px 0 10px;color:#5b3a53">You just made my world ‚Äî I promise to make yours brighter every day.</p>

    <!-- typed letter area -->
    <div class="letterBox" id="letterBox" aria-live="polite" aria-atomic="true">
      <div style="font-weight:700;margin-bottom:6px;color:#7a3b5b">A special letter for you</div>
      <div class="letterText" id="letterText">
        <!-- typed text goes here -->
      </div>
    </div>

    <!-- gift reveal -->
    <div class="giftWrap" id="giftWrap" aria-hidden="true">
      <img id="chocImg" class="choc" src="chocolate.gif" alt="Chocolate gift (replace chocolate.gif)">
      <img id="pandaImg" class="panda" src="panda.gif" alt="Panda dance (replace panda.gif)">
      <div class="giftBtns">
        <button id="openGift" class="small" type="button">Open Gift üç´</button>
        <button id="downloadLetter" class="download" type="button">Download Letter</button>
        <button id="printLetter" class="small" type="button">Print</button>
      </div>
    </div>

    <div style="margin-top:12px;">
      <button id="closeModal" class="small" type="button">Close</button>
    </div>
  </div>
</div>

<!-- confetti canvas -->
<canvas class="confetti-canvas" id="confettiCanvas" aria-hidden="true"></canvas>

<!-- hidden iframes for music -->
<div class="iframes" aria-hidden="true">
  <!-- background music starts muted for autoplay compatibility -->
  <!-- Replace BG_VIDEO_ID with your preferred video ID -->
  <iframe id="bgMusic" src="https://www.youtube.com/embed/BG_VIDEO_ID?autoplay=1&mute=1&loop=1&playlist=BG_VIDEO_ID&controls=0&rel=0&modestbranding=1&iv_load_policy=3"></iframe>

  <!-- YES song iframe (set src on YES) - Replace YES_VIDEO_ID with your YES song video ID -->
  <iframe id="yesMusic" src="" allow="autoplay"></iframe>
</div>

<script>
/* -------------------------
   Editable letter content
   ------------------------- */
const myLetter = `Hey love,

From the moment I met you, everything started to feel brighter. Your laugh, your little habits, the way you look at the world ‚Äî I want to be the person who keeps that smile on your face.

I promise to support you, to listen, to make you chai when you're tired, to celebrate your wins and hold you on rainy days. I might not be perfect, but I will always try to be better for you.

Say yes, and let‚Äôs make the sweetest memories together.

‚Äî [Your Name] üíñ`;

/* -------------------------
   Elements
   ------------------------- */
const yesBtn = document.getElementById('yesBtn');
const noBtn = document.getElementById('noBtn');
const noTooltip = document.getElementById('noTooltip');
const modal = document.getElementById('modal');
const closeModal = document.getElementById('closeModal');
const letterText = document.getElementById('letterText');
const giftWrap = document.getElementById('giftWrap');
const openGift = document.getElementById('openGift');
const chocImg = document.getElementById('chocImg');
const pandaImg = document.getElementById('pandaImg');
const downloadLetter = document.getElementById('downloadLetter');
const printLetter = document.getElementById('printLetter');
const bgIframe = document.getElementById('bgMusic');
const yesIframe = document.getElementById('yesMusic');
const noCountEl = document.getElementById('noCount');
const yesCountEl = document.getElementById('yesCount');

let tooltipInterval = null;
let noCount = 0;
let yesCount = 0;

/* -------------------------
   NO tooltip cycling (desktop hover) & touch fallback
   ------------------------- */
const reasons = [
  "Because I‚Äôll make you smile every single day.",
  "Because you already live in my mind rent-free.",
  "Because you deserve someone who chooses you every time ‚Äî and that‚Äôs me.",
  "Because together we‚Äôll be the cutest couple ever.",
  "Because I make great snacks and share them. üòÑ",
  "Because I will never let you feel alone.",
  "Because saying yes will make my entire universe brighter."
];

function randReason(){ return reasons[Math.floor(Math.random()*reasons.length)]; }

noBtn.addEventListener('mouseenter', () => {
  noTooltip.textContent = randReason();
  if(tooltipInterval) clearInterval(tooltipInterval);
  tooltipInterval = setInterval(()=>{ noTooltip.textContent = randReason(); }, 1400);
  noBtn.classList.remove('wiggle');
});
noBtn.addEventListener('mouseleave', () => {
  if(tooltipInterval) clearInterval(tooltipInterval);
  tooltipInterval = null;
});
noBtn.addEventListener('touchstart', (e) => {
  noTooltip.textContent = randReason();
  if(tooltipInterval) clearInterval(tooltipInterval);
  tooltipInterval = setInterval(()=>{ noTooltip.textContent = randReason(); }, 1400);
}, {passive:true});
noBtn.addEventListener('touchend', (e) => {
  if(tooltipInterval) clearInterval(tooltipInterval);
  tooltipInterval = null;
}, {passive:true});

/* -------------------------
   Typed-letter function
   ------------------------- */
function typeLetter(text, el, cb){
  el.textContent = '';
  const chars = Array.from(text);
  let i = 0;
  function step(){
    if(i >= chars.length){
      if(cb) cb();
      return;
    }
    const ch = chars[i++];
    el.textContent += ch;
    let delay = 28 + Math.random()*18;
    if(ch === ',' ) delay = 90;
    if(ch === '.' ) delay = 160;
    if(ch === '\n') delay = 210;
    setTimeout(step, delay);
  }
  step();
}

/* -------------------------
   Confetti (vanilla) - small lightweight implementation
   ------------------------- */
const confettiCanvas = document.getElementById('confettiCanvas');
const confettiCtx = confettiCanvas.getContext('2d');
let confettiPieces = [];
function resizeCanvas(){ confettiCanvas.width = innerWidth; confettiCanvas.height = innerHeight; }
window.addEventListener('resize', resizeCanvas);
resizeCanvas();

function spawnConfetti(count){
  confettiPieces = confettiPieces.concat(Array.from({length:count}).map(() => {
    return {
      x: Math.random()*confettiCanvas.width,
      y: -10 - Math.random()*200,
      vx: (Math.random()-0.5)*4,
      vy: 2 + Math.random()*4,
      size: 6 + Math.random()*10,
      rot: Math.random()*360,
      rotSpeed: (Math.random()-0.5)*8,
      color: `hsl(${Math.floor(Math.random()*360)} ${60 + Math.random()*40}% ${55 + Math.random()*20}%)`,
      life: 300 + Math.random()*200
    };
  }));
  if(!confettiRunning) requestAnimationFrame(confettiLoop);
}
let confettiRunning = false;
function confettiLoop(){
  confettiRunning = true;
  confettiCtx.clearRect(0,0,confettiCanvas.width, confettiCanvas.height);
  for(let i = confettiPieces.length-1; i >= 0; i--){
    const p = confettiPieces[i];
    p.x += p.vx;
    p.y += p.vy;
    p.vy += 0.06; // gravity
    p.rot += p.rotSpeed;
    p.life--;
    // draw rectangle rotated
    confettiCtx.save();
    confettiCtx.translate(p.x, p.y);
    confettiCtx.rotate(p.rot*Math.PI/180);
    confettiCtx.fillStyle = p.color;
    confettiCtx.fillRect(-p.size/2, -p.size/2, p.size, p.size*0.6);
    confettiCtx.restore();
    if(p.y > confettiCanvas.height + 40 || p.life < 0) confettiPieces.splice(i,1);
  }
  if(confettiPieces.length > 0) requestAnimationFrame(confettiLoop);
  else confettiRunning = false;
}

/* -------------------------
   Background music control helpers
   ------------------------- */
function stopBgMusic(){
  try{
    // stop reliably by clearing src
    if(bgIframe && bgIframe.src && bgIframe.src !== ''){
      bgIframe.src = '';
    }
  }catch(e){}
}
function stopYesMusic(){
  try{
    if(yesIframe && yesIframe.src && yesIframe.src !== ''){
      yesIframe.src = '';
    }
  }catch(e){}
}
function playYesMusic(videoId){
  // ensure background music is stopped
  stopBgMusic();
  // set yes iframe
  yesIframe.src = `https://www.youtube.com/embed/${videoId}?autoplay=1&loop=1&playlist=${videoId}&controls=0&rel=0&modestbranding=1&iv_load_policy=3`;
}

/* -------------------------
   YES click: open modal, type letter, reveal gift, play YES song and confetti
   ------------------------- */
yesBtn.addEventListener('click', (e) => {
  yesCount++;
  yesCountEl.textContent = yesCount;

  // stop background music first (clear src)
  stopBgMusic();

  // set yes music src (replace YES_VIDEO_ID with your ID or pass as param)
  playYesMusic('YES_VIDEO_ID'); // <-- REPLACE YES_VIDEO_ID with the YouTube video ID you want

  // show modal
  modal.classList.add('open');
  modal.setAttribute('aria-hidden','false');

  // prepare letter + gift
  letterText.textContent = '';
  giftWrap.setAttribute('aria-hidden','true');
  chocImg.classList.remove('revealed');
  pandaImg.classList.remove('revealed');
  openGift.disabled = false;
  openGift.textContent = 'Open Gift üç´';

  // small pop on YES button
  yesBtn.animate([{transform:'scale(1)'},{transform:'scale(1.06)'},{transform:'scale(1)'}],{duration:420});

  // start confetti and type the letter
  spawnConfetti(60);

  setTimeout(()=> {
    typeLetter(myLetter, letterText, () => {
      giftWrap.setAttribute('aria-hidden','false');
      openGift.focus();
    });
  }, 360);
});

/* -------------------------
   Open gift: reveal chocolate then panda dance
   ------------------------- */
openGift.addEventListener('click', () => {
  chocImg.classList.add('revealed');
  chocImg.animate([{transform:'translateY(0)'},{transform:'translateY(-8px)'},{transform:'translateY(0)'}],{duration:700,iterations:1,easing:'ease-out'});
  openGift.disabled = true;
  openGift.textContent = 'Opened üç´';

  // after a short delay reveal panda dance as extra surprise
  setTimeout(()=>{
    pandaImg.classList.add('revealed');
    // small bounce
    pandaImg.animate([{transform:'translateY(8px)'},{transform:'translateY(-6px)'},{transform:'translateY(0)'}],{duration:900,iterations:1,easing:'ease-out'});
  }, 650);
});

/* -------------------------
   Download & Print
   ------------------------- */
downloadLetter.addEventListener('click', () => {
  const filename = 'my_love_letter.txt';
  const blob = new Blob([myLetter], {type: 'text/plain;charset=utf-8'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = filename;
  document.body.appendChild(a);
  a.click();
  a.remove();
  URL.revokeObjectURL(url);
});

printLetter.addEventListener('click', () => {
  const win = window.open('', '_blank', 'noopener');
  if(!win) { alert('Popup blocked ‚Äî please allow popups to print.'); return; }
  const html = `
    <html><head><title>My letter</title>
    <style>body{font-family:Inter, Poppins, sans-serif;padding:28px;color:#3b2b3b} pre{white-space:pre-wrap;font-size:16px;line-height:1.45}</style>
    </head><body><h2>My special letter</h2><pre>${escapeHtml(myLetter)}</pre></body></html>`;
  win.document.open();
  win.document.write(html);
  win.document.close();
  setTimeout(()=>{ win.print(); }, 450);
});

function escapeHtml(s){ return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

/* -------------------------
   Close modal
   ------------------------- */
closeModal.addEventListener('click', () => {
  modal.classList.remove('open');
  modal.setAttribute('aria-hidden','true');
  // stop yes music
  stopYesMusic();
  // optionally restart background music by setting bg src again (if you want background to resume, provide BG_VIDEO_ID)
  // Example: bgIframe.src = 'https://www.youtube.com/embed/BG_VIDEO_ID?autoplay=1&mute=0&loop=1&playlist=BG_VIDEO_ID&controls=0';
  // For now we leave it stopped to avoid autoplay issues.
  // reset open gift button + visuals
  openGift.disabled = false;
  openGift.textContent = 'Open Gift üç´';
  chocImg.classList.remove('revealed');
  pandaImg.classList.remove('revealed');
});

/* -------------------------
   NO button playful behavior & counting
   ------------------------- */
noBtn.addEventListener('click', (e) => {
  noCount++;
  noCountEl.textContent = noCount;

  // quick nudge + change text briefly
  noBtn.classList.add('wiggle');
  setTimeout(()=> noBtn.classList.remove('wiggle'), 820);
  const r = randReason();
  const old = noBtn.textContent;
  noBtn.textContent = 'No üòø ‚Äî ' + r;
  // restore label after 2.5s
  setTimeout(()=>{ noBtn.innerHTML = 'NO üòø<div class="tooltip" id="noTooltip">Hover for a reason...</div>'; }, 2500);
});

/* -------------------------
   Small accessibility: keyboard
   ------------------------- */
yesBtn.addEventListener('keydown', (e)=>{ if(e.key==='Enter' || e.key===' ') { e.preventDefault(); yesBtn.click(); }});
noBtn.addEventListener('keydown', (e)=>{ if(e.key==='Enter' || e.key===' ') { e.preventDefault(); noBtn.click(); }});

/* -------------------------
   Attempt to unmute background after user gesture (optional)
   ------------------------- */
function tryUnmuteBackgroundOnGesture(){
  if(!bgIframe) return;
  try{
    const src = bgIframe.src || '';
    if(src.includes('mute=1')){
      const newSrc = src.replace('mute=1','mute=0');
      // if you want autoplay with sound, browser may block until user gesture; we attempt it after interaction
      bgIframe.src = newSrc;
    }
  }catch(e){}
}
document.addEventListener('pointerdown', function onFirst(){ tryUnmuteBackgroundOnGesture(); document.removeEventListener('pointerdown', onFirst); }, {passive:true});

/* -------------------------
   Helpful: stop any playing iframes when page unloads
   ------------------------- */
window.addEventListener('beforeunload', () => {
  stopBgMusic();
  stopYesMusic();
});

/* -------------------------
   Notes for you:
   1) Replace these placeholders:
      - you.jpg, crush.jpg, chocolate.gif, panda.gif
      - BG_VIDEO_ID  (background YouTube video id)
      - YES_VIDEO_ID (Yes celebration YouTube video id)
   2) If you want the background music to resume after closing the modal, uncomment and edit the line near closeModal where we mention bgIframe.src.
   3) If you want to email results (counts) somewhere, that requires server-side code or an API endpoint ‚Äî I can help add that next if you want.
*/
</script>
</body>
</html>

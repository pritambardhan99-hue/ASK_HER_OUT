<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>Will you be my girlfriend? üíñ</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#fff0f8;
    --accent:#ff6fb5;
    --accent2:#ffd166;
    --muted:#444;
  }
  html,body{height:100%;margin:0;font-family: 'Poppins', system-ui, sans-serif;background:linear-gradient(160deg,#ffeef7 0%, #fff7ea 60%);overflow:hidden}
  .wrap{position:relative; z-index:2; min-height:100vh; display:flex; align-items:center; justify-content:center; flex-direction:column; gap:12px; padding:24px; text-align:center}
  h1{font-size: clamp(20px,6vw,36px); margin:0 0 6px; color:var(--muted)}
  p.lead{margin:0;color:#7d5a7a; font-size:clamp(13px,3.4vw,16px)}
  .buttons{display:flex; gap:14px; align-items:center; justify-content:center; margin-top:14px; flex-wrap:wrap}
  .btn{position:relative;padding:16px 26px;border-radius:14px;font-weight:800;font-size:18px;cursor:pointer;user-select:none;box-shadow:0 8px 22px rgba(0,0,0,0.12);min-width:140px;min-height:52px;touch-action:manipulation;background:#fff}
  .btn:focus{outline:3px solid rgba(255,111,181,0.16)}
  .yes{background:linear-gradient(135deg,#ff9ccf,#ff6fb5);color:white;border:none; transition:transform .16s ease, box-shadow .16s ease; will-change:transform}
  .yes:hover{ transform:scale(1.04); box-shadow:0 16px 38px rgba(255,111,181,0.22) }
  .no{background:linear-gradient(135deg,#ffffff,#ffe6f1);border:2px solid #ffd6ea;color:#b9417b; transition:transform .22s cubic-bezier(.18,.9,.4,1)}
  .no.wiggle{ animation: wiggle .8s ease-in-out; }
  @keyframes wiggle{ 0%{transform:translateX(0)}25%{transform:translateX(-8px)}50%{transform:translateX(6px)}75%{transform:translateX(-4px)}100%{transform:translateX(0)} }

  /* Tooltip (desktop hover) */
  .tooltip{
    position:absolute; bottom: calc(100% + 12px); left:50%; transform:translateX(-50%) translateY(6px);
    background:#fff;padding:10px 12px;border-radius:10px;box-shadow:0 8px 30px rgba(0,0,0,0.12);
    font-size:13px;color:#6b3a58;white-space:nowrap; opacity:0; pointer-events:none; transition:all .16s;
    z-index:6;
  }
  .btn:hover .tooltip{ opacity:1; transform:translateX(-50%) translateY(0); }

  .modal{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(10,10,10,0.45);z-index:50;opacity:0;pointer-events:none;transition:opacity .2s}
  .modal.open{opacity:1;pointer-events:auto}
  .dialog{background:linear-gradient(180deg,#fff 0%, #fff7ff 100%);border-radius:16px;padding:18px;width:min(720px,94%);text-align:center;box-shadow:0 18px 60px rgba(0,0,0,0.28);position:relative;max-height:86vh;overflow:auto}
  .profile-row{display:flex;gap:12px;align-items:center;justify-content:center;margin-bottom:10px}
  .profile-row img{width:88px;height:88px;object-fit:cover;border-radius:12px;box-shadow:0 10px 28px rgba(255,111,181,0.14)}
  .love-stream{display:flex;gap:6px;justify-content:center;flex-wrap:wrap;margin-top:12px}
  .love-stream span{font-size:22px;animation:pop 1.2s ease-in-out infinite}
  @keyframes pop{0%{transform:translateY(0) scale(.9)}50%{transform:translateY(-8px) scale(1.12)}100%{transform:translateY(0) scale(.95)}}

  /* Letter box */
  .letterBox{margin-top:12px;text-align:left;background:#fff7fb;border-radius:12px;padding:14px;box-shadow:0 6px 20px rgba(0,0,0,0.06);font-size:15px;color:#5b3a53;line-height:1.45;min-height:110px}
  .letterText{white-space:pre-wrap; min-height:90px; font-family:inherit; font-size:15px}

  /* chocolate gift */
  .giftWrap{margin-top:12px;display:flex;flex-direction:column;gap:8px;align-items:center}
  .choc{width:160px;height:160px;object-fit:contain;border-radius:12px;box-shadow:0 12px 36px rgba(0,0,0,0.12);opacity:0;transform:scale(.8);transition:all .42s cubic-bezier(.2,.9,.28,1)}
  .choc.revealed{opacity:1;transform:scale(1)}
  .giftBtns{display:flex;gap:10px;flex-wrap:wrap;justify-content:center;margin-top:6px}

  .small{padding:10px 14px;border-radius:10px;font-weight:700;background:#fff;border:2px solid #f1d3e4;color:#6a3653}
  .download{background:linear-gradient(135deg,#ffd166,#ffb6d5);color:#5b2a4a;border:none;padding:10px 14px;border-radius:10px;font-weight:800}

  /* hidden iframes */
  .iframes{display:none}

  /* responsive */
  @media (max-width:480px){
    .profile-row img{width:72px;height:72px}
    .choc{width:140px;height:140px}
    .btn:hover .tooltip{ opacity:0; transform:translateX(-50%) translateY(6px);} /* no hover on small screens */
  }
</style>
</head>
<body>
<div class="wrap">
  <h1>Will you be my girlfriend? üíó</h1>
  <p class="lead">Because I‚Äôll make you smile every single day. Choose carefully (but I hope you choose yes!)</p>

  <div class="buttons">
    <button id="yesBtn" class="btn yes" type="button">YES ‚ù§</button>
    <button id="noBtn" class="btn no" type="button">NO üòø
      <div class="tooltip" id="noTooltip">Hover for a reason...</div>
    </button>
  </div>
</div>

<!-- modal -->
<div id="modal" class="modal" aria-hidden="true">
  <div class="dialog" role="dialog" aria-modal="true" aria-labelledby="yesTitle">
    <div class="profile-row">
      <img id="imgYou" src="you.jpg" alt="You (replace you.jpg)">
      <img id="imgCrush" src="crush.jpg" alt="Her (replace crush.jpg)">
    </div>

    <h2 id="yesTitle">She said YES! üéâ</h2>
    <p style="margin:6px 0 10px;color:#5b3a53">You just made my world ‚Äî I promise to make yours brighter every day.</p>

    <!-- typed letter area -->
    <div class="letterBox" id="letterBox" aria-live="polite" aria-atomic="true">
      <div style="font-weight:700;margin-bottom:6px;color:#7a3b5b">A special letter for you</div>
      <div class="letterText" id="letterText">
        <!-- typed text goes here -->
      </div>
    </div>

    <!-- gift reveal -->
    <div class="giftWrap" id="giftWrap" aria-hidden="true">
      <img id="chocImg" class="choc" src="chocolate.gif" alt="Chocolate gift (replace chocolate.gif)">
      <div class="giftBtns">
        <button id="openGift" class="small" type="button">Open Gift üç´</button>
        <button id="downloadLetter" class="download" type="button">Download Letter</button>
        <button id="printLetter" class="small" type="button">Print</button>
      </div>
    </div>

    <div style="margin-top:12px;">
      <button id="closeModal" class="small" type="button">Close</button>
    </div>
  </div>
</div>

<!-- hidden iframes for music -->
<div class="iframes" aria-hidden="true">
  <!-- background music starts muted for autoplay compatibility -->
  <!-- Replace 8NFYPGgmfV8 with your preferred video ID -->
  <iframe id="bgMusic" src="https://www.youtube.com/embed/8NFYPGgmfV8?autoplay=1&mute=1&loop=1&playlist=8NFYPGgmfV8&controls=0&rel=0&modestbranding=1&iv_load_policy=3" allow="autoplay"></iframe>

  <!-- YES song iframe (set src on YES) - Replace BddP6PYo2gs with your YES song video ID -->
  <iframe id="yesMusic" src="" allow="autoplay"></iframe>
</div>

<script>
/* -------------------------
   Editable letter content
   Replace the text below with your own message. Keep line breaks using \n.
   ------------------------- */
const myLetter = `Hey love,

From the moment I met you, everything started to feel brighter. Your laugh, your little habits, the way you look at the world ‚Äî I want to be the person who keeps that smile on your face.

I promise to support you, to listen, to make you chai when you're tired, to celebrate your wins and hold you on rainy days. I might not be perfect, but I will always try to be better for you.

Say yes, and let‚Äôs make the sweetest memories together.

‚Äî [Your Name] üíñ`;

/* -------------------------
   Elements
   ------------------------- */
const yesBtn = document.getElementById('yesBtn');
const noBtn = document.getElementById('noBtn');
const noTooltip = document.getElementById('noTooltip');
const modal = document.getElementById('modal');
const closeModal = document.getElementById('closeModal');
const letterText = document.getElementById('letterText');
const giftWrap = document.getElementById('giftWrap');
const openGift = document.getElementById('openGift');
const chocImg = document.getElementById('chocImg');
const downloadLetter = document.getElementById('downloadLetter');
const printLetter = document.getElementById('printLetter');
const bgIframe = document.getElementById('bgMusic');
const yesIframe = document.getElementById('yesMusic');

let tooltipInterval = null;

/* -------------------------
   NO tooltip cycling (desktop hover) & touch fallback
   ------------------------- */
const reasons = [
  "Because I‚Äôll make you smile every single day.",
  "Because you already live in my mind rent-free.",
  "Because you deserve someone who chooses you every time ‚Äî and that‚Äôs me.",
  "Because together we‚Äôll be the cutest couple ever.",
  "Because I make great snacks and share them. üòÑ",
  "Because I will never let you feel alone.",
  "Because saying yes will make my entire universe brighter."
];

function randReason(){ return reasons[Math.floor(Math.random()*reasons.length)]; }

// Desktop hover: start cycling reasons
noBtn.addEventListener('mouseenter', () => {
  noTooltip.textContent = randReason();
  if(tooltipInterval) clearInterval(tooltipInterval);
  tooltipInterval = setInterval(()=>{ noTooltip.textContent = randReason(); }, 1400);
  // small wiggle occasionally
  noBtn.classList.remove('wiggle');
});
noBtn.addEventListener('mouseleave', () => {
  if(tooltipInterval) clearInterval(tooltipInterval);
  tooltipInterval = null;
});

// Touch: on touchstart show tooltip briefly and cycle while touching
noBtn.addEventListener('touchstart', (e) => {
  noTooltip.textContent = randReason();
  noBtn.classList.add('show-tooltip');
  if(tooltipInterval) clearInterval(tooltipInterval);
  tooltipInterval = setInterval(()=>{ noTooltip.textContent = randReason(); }, 1400);
}, {passive:true});
noBtn.addEventListener('touchend', (e) => {
  if(tooltipInterval) clearInterval(tooltipInterval);
  tooltipInterval = null;
  noBtn.classList.remove('show-tooltip');
}, {passive:true});

/* -------------------------
   Typed-letter function
   ------------------------- */
function typeLetter(text, el, cb){
  el.textContent = '';
  const chars = Array.from(text);
  let i = 0;
  function step(){
    if(i >= chars.length){
      if(cb) cb();
      return;
    }
    const ch = chars[i++];
    el.textContent += ch;
    let delay = 28 + Math.random()*18;
    if(ch === ',' ) delay = 90;
    if(ch === '.' ) delay = 160;
    if(ch === '\n') delay = 210;
    setTimeout(step, delay);
  }
  step();
}

/* -------------------------
   Background music unmute helper
   ------------------------- */
let bgUnmuted = false;
function tryUnmuteBackgroundOnGesture(){
  if(bgUnmuted) return;
  try{
    // replace iframe src without &mute=1 to attempt unmuting (works only if browser allows)
    const src = bgIframe.src;
    if(src && src.indexOf('mute=1') !== -1){
      const newSrc = src.replace('mute=1','mute=0');
      // set after a small gesture, but only if document has user gesture
      bgIframe.src = newSrc;
      bgUnmuted = true;
    }
  }catch(e){}
}

// Resume on first user click/tap (some browsers require)
document.addEventListener('click', function one(){
  tryUnmuteBackgroundOnGesture();
  document.removeEventListener('click', one);
}, {passive:true});

/* -------------------------
   YES click: open modal, type letter, reveal gift, play YES song and stop background
   ------------------------- */
yesBtn.addEventListener('click', (e) => {
  // hide background iframe (most reliable way to stop)
  try{ bgIframe.style.display = 'none'; }catch(e){}
  // set yes music src (autoplay param)
  // Replace BddP6PYo2gs with any YouTube video id you want for the YES song
  yesIframe.src = 'https://www.youtube.com/embed/BddP6PYo2gs?autoplay=1&loop=1&playlist=BddP6PYo2gs&controls=0&rel=0&modestbranding=1&iv_load_policy=3';
  // show modal
  modal.classList.add('open');
  modal.setAttribute('aria-hidden','false');

  // prepare letter + gift
  letterText.textContent = '';
  giftWrap.setAttribute('aria-hidden','true');
  chocImg.classList.remove('revealed');
  openGift.disabled = false;
  openGift.textContent = 'Open Gift üç´';

  // small pop on YES button
  yesBtn.animate([{transform:'scale(1)'},{transform:'scale(1.06)'},{transform:'scale(1)'}],{duration:420});

  // type the letter
  setTimeout(()=> {
    typeLetter(myLetter, letterText, () => {
      giftWrap.setAttribute('aria-hidden','false');
      openGift.focus();
    });
  }, 360);
});

/* -------------------------
   Open gift
   ------------------------- */
openGift.addEventListener('click', () => {
  chocImg.classList.add('revealed');
  chocImg.animate([{transform:'translateY(0)'},{transform:'translateY(-8px)'},{transform:'translateY(0)'}],{duration:700,iterations:1,easing:'ease-out'});
  openGift.disabled = true;
  openGift.textContent = 'Opened üç´';
});

/* -------------------------
   Download & Print
   ------------------------- */
downloadLetter.addEventListener('click', () => {
  const filename = 'my_love_letter.txt';
  const blob = new Blob([myLetter], {type: 'text/plain;charset=utf-8'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = filename;
  document.body.appendChild(a);
  a.click();
  a.remove();
  URL.revokeObjectURL(url);
});

printLetter.addEventListener('click', () => {
  const win = window.open('', '_blank', 'noopener');
  if(!win) { alert('Popup blocked ‚Äî please allow popups to print.'); return; }
  const html = `
    <html><head><title>My letter</title>
    <style>body{font-family:Inter, Poppins, sans-serif;padding:28px;color:#3b2b3b} pre{white-space:pre-wrap;font-size:16px;line-height:1.45}</style>
    </head><body><h2>My special letter</h2><pre>${escapeHtml(myLetter)}</pre></body></html>`;
  win.document.open();
  win.document.write(html);
  win.document.close();
  setTimeout(()=>{ win.print(); }, 450);
});

function escapeHtml(s){ return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

/* -------------------------
   Close modal
   ------------------------- */
closeModal.addEventListener('click', () => {
  modal.classList.remove('open');
  modal.setAttribute('aria-hidden','true');
  // stop yes music
  try{ yesIframe.src = ''; }catch(e){}
  // show background iframe again and attempt to unmute if allowed
  try{ bgIframe.style.display = ''; tryUnmuteBackgroundOnGesture(); }catch(e){}
  // reset open gift button
  openGift.disabled = false;
  openGift.textContent = 'Open Gift üç´';
  chocImg.classList.remove('revealed');
});

/* -------------------------
   NO button playful behavior
   ------------------------- */
noBtn.addEventListener('click', (e) => {
  // quick nudge + change text briefly
  noBtn.classList.add('wiggle');
  setTimeout(()=> noBtn.classList.remove('wiggle'), 820);
  const r = randReason();
  const old = noBtn.textContent;
  noBtn.textContent = 'No üòø ‚Äî ' + r;
  // restore label after 2.5s
  setTimeout(()=>{ noBtn.innerHTML = 'NO üòø<div class="tooltip" id="noTooltip">Hover for a reason...</div>'; }, 2500);
});

/* -------------------------
   Small accessibility: keyboard
   ------------------------- */
yesBtn.addEventListener('keydown', (e)=>{ if(e.key==='Enter' || e.key===' ') { e.preventDefault(); yesBtn.click(); }});
noBtn.addEventListener('keydown', (e)=>{ if(e.key==='Enter' || e.key===' ') { e.preventDefault(); noBtn.click(); }});

/* -------------------------
   Allow attempt to unmute background after initial gesture
   ------------------------- */
function tryUnmuteBackgroundOnGesture(){
  if(!bgIframe) return;
  try{
    const src = bgIframe.src || '';
    if(src.includes('mute=1')){
      const newSrc = src.replace('mute=1','mute=0');
      bgIframe.src = newSrc;
    }
  }catch(e){}
}

// try to unmute once the user interacts
document.addEventListener('pointerdown', function onFirst(){ tryUnmuteBackgroundOnGesture(); document.removeEventListener('pointerdown', onFirst); }, {passive:true});
</script>
</body>
</html>
